{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@nodeloc/flarum-ext-referral/webpack/bootstrap","webpack://@nodeloc/flarum-ext-referral/webpack/runtime/compat get default export","webpack://@nodeloc/flarum-ext-referral/webpack/runtime/define property getters","webpack://@nodeloc/flarum-ext-referral/webpack/runtime/hasOwnProperty shorthand","webpack://@nodeloc/flarum-ext-referral/webpack/runtime/make namespace object","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['forum/app']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/extend']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@nodeloc/flarum-ext-referral/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nodeloc/flarum-ext-referral/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/components/Page']\"","webpack://@nodeloc/flarum-ext-referral/./src/forum/pages/RedirectToHomeAndOpenModalPage.js","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['forum/components/SignUpModal']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@nodeloc/flarum-ext-referral/./src/forum/pages/SignupPage.js","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/extenders']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['components/IndexPage']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/components/Button']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@nodeloc/flarum-ext-referral/./src/forum/modals/BuyInviteCode.js","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/Component']\"","webpack://@nodeloc/flarum-ext-referral/external root \"flarum.core.compat['common/components/Alert']\"","webpack://@nodeloc/flarum-ext-referral/./src/forum/pages/StoreIndex.js","webpack://@nodeloc/flarum-ext-referral/./src/forum/extend.js","webpack://@nodeloc/flarum-ext-referral/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","import app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\n\nexport default class RedirectToHomeAndOpenModalPage extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    m.route.set('/');\n\n    setTimeout(() => app.modal.show(this.createModal()), 1500);\n  }\n\n  createModal() {\n    return null;\n  }\n\n  view() {\n    return m('div');\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SignUpModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","import app from 'flarum/forum/app';\nimport RedirectToHomeAndOpenModalPage from './RedirectToHomeAndOpenModalPage';\nimport SignUpModal from 'flarum/forum/components/SignUpModal';\nimport Stream from 'flarum/common/utils/Stream';\n\nexport default class SignupPage extends RedirectToHomeAndOpenModalPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n    // 从 URL 中获取 doorkey 参数\n    app.doorkey = vnode.attrs.doorkey || '';\n  }\n\n  createModal() {\n    if (!app.session.user) {\n      return SignUpModal;\n    }\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/listItems'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport Stream from 'flarum/common/utils/Stream';\n\nexport default class BuyInviteCode extends Modal {\n  constructor() {\n    super();\n    this.invite_code_price = app.forum.attribute('invite_code_price');\n    this.invite_code_reward = app.forum.attribute('invite_code_reward');\n    this.invite_code_max_number = app.forum.attribute('invite_code_max_number');\n    this.invite_code_expires = app.forum.attribute('invite_code_expires');\n    this.key_count = Stream('0');\n  }\n\n  className() {\n    return 'store-buy Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('nodeloc-referral.forum.purchase_invite_code');\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n    this.loading = true;\n\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/store/referral',\n      body: {\n        key_count: this.key_count(),\n      },\n    }).then((result) => {\n      this.loading = false;\n      if (result.error) {\n        app.alerts.show(\n          {\n            type: 'error',\n          },\n          result.error\n        );\n        return;\n      }\n\n      // Clear email and message\n      this.key_count('0');\n      // Close the purchase box\n      this.hide();\n      m.route.set(m.route.get()); // 刷新当前路由的页面\n    });\n  }\n\n  content() {\n    return (\n      <div className=\"container buy-store-layer\">\n        <div className=\"Form\">\n          <div className=\"helpText\">\n            {app.translator.trans('nodeloc-referral.forum.purchase_help_tip', {\n              invite_code_price: this.invite_code_price,\n              invite_code_reward: this.invite_code_reward\n            })}\n          </div>\n          <div className=\"Form-group\">\n            <label\n              for=\"buy-store-to-mail\">{app.translator.trans('nodeloc-referral.forum.purchase_invite_code', {invite_code_max_number: this.invite_code_max_number})}</label>\n            <div\n              className=\"helpText\">{app.translator.trans('nodeloc-referral.forum.purchase_expire_tip', {invite_code_expires: this.invite_code_expires})} </div>\n            <input\n              required\n              id=\"buy-store-to-mail\"\n              className=\"FormControl\"\n              type=\"number\"\n              bidi={this.key_count}\n            />\n          </div>\n          <Button\n            className=\"Button Button--primary\"\n            type=\"submit\"\n            loading={this.loading}\n            onclick={(e) => this.onsubmit(e)}\n          >\n            购买\n          </Button>\n        </div>\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Alert'];","import IndexPage from 'flarum/components/IndexPage';\nimport app from 'flarum/forum/app';\nimport listItems from 'flarum/common/helpers/listItems';\nimport Button from 'flarum/common/components/Button';\nimport BuyInviteCode from \"../modals/BuyInviteCode\";\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Component from 'flarum/common/Component';\nimport Alert from 'flarum/common/components/Alert';\n\nexport default class StoreIndex extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    app.setTitle(app.translator.trans('nodeloc-referral.forum.referral'));\n    app.setTitleCount(0);\n    const invite_code_price = app.forum.attribute(\"invite_code_price\");\n    const invite_code_max_number = app.forum.attribute(\"invite_code_max_number\");\n    const invite_code_expires = app.forum.attribute(\"invite_code_expires\");\n    // 接口请求\n    app.request({\n      method: 'GET',\n      url: app.forum.attribute('apiUrl') + '/store/referral/show',\n    }).then(response => {\n      // 确保 response 包含 data 属性\n      if (response.data) {\n        this.records = response;\n        m.redraw()\n      }\n    }); // 使用 .then 触发重绘\n  }\n\n  view() {\n    return (\n      <div className=\"IndexPage\">\n        {IndexPage.prototype.hero()}\n        <div className=\"container\">\n          <div className=\"sideNavContainer\">\n            <nav className=\"IndexPage-nav sideNav\">\n              <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\n            </nav>\n            <div class=\"StoreIndex\">\n              <div class=\"container\">\n                <div class=\"sideNavContainer\">\n                  <div class=\"StoreIndex-results sideNavOffset\">\n                    <Button\n                      class=\"Button Button--primary\"\n                      onclick={() => {\n                        app.modal.show(BuyInviteCode);\n                      }}\n                    >\n                      {app.translator.trans('nodeloc-referral.forum.purchase_invite_code')}\n                    </Button>\n                    <div class=\"StoreIndex-Body\">\n                      {this.records ? this.recordsContent() :\n                        <LoadingIndicator/>}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  recordsContent() {\n    const formatDate = (timestamp) => {\n      const date = new Date(timestamp);\n      return date.toLocaleString(); // 使用本地格式显示日期和时间\n    };\n    const copyToClipboard = (text) => {\n      const tempInput = document.createElement('textarea');\n      tempInput.value = app.forum.attribute('baseUrl') + '/signup/'+text;\n      document.body.appendChild(tempInput);\n      tempInput.select();\n      document.execCommand('copy');\n      document.body.removeChild(tempInput);\n      // 显示复制成功的提示消息\n      app.alerts.show(Alert, {type: 'success'}, \"邀请码已复制到剪贴板\");\n    };\n    console.log(\"records:\",this.records.data.attributes);\n    if (!this.records.data.attributes || this.records.data.attributes.length === 0) {\n      return \"\";\n    }\n    return (\n      <div className=\"ReferralHistoryContainer\">\n        <ul>\n          {this.records.data.attributes.map(record => (\n            <li key={record.id}\n                className=\"copyable-item\"\n                onclick={() => copyToClipboard(record.doorkey.key)}\n                >\n              <p> {app.translator.trans('nodeloc-referral.forum.create_time')}: {formatDate(record.created_at)}</p>\n              <p>\n                {app.translator.trans('nodeloc-referral.forum.invite_code')}: <span className=\"copyable\">{record.doorkey.key}</span>\n              </p>\n              <p> {app.translator.trans('nodeloc-referral.forum.count')}: {parseInt(record.key_count) - parseInt(record.actives)}\n              </p>\n              <p> {app.translator.trans('nodeloc-referral.forum.cost')}: {record.key_cost} 能量</p>\n              <p> {app.translator.trans('nodeloc-referral.forum.actives')}: {record.actives}</p>\n              <p> {app.translator.trans('nodeloc-referral.forum.is_expire')}: {record.is_expire? '是' : '否'}</p>\n            </li>\n          ))}\n        </ul>\n      </div>\n    );\n  }\n}\n","import Extend from 'flarum/common/extenders';\nimport StoreIndex from \"./pages/StoreIndex\";\n\nexport default [\n  new Extend.Routes()\n    .add('nodeloc.referral.store.index', '/store', StoreIndex),\n];\n","import app from 'flarum/forum/app';\nimport {extend} from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport SignupPage from \"./pages/SignupPage\";\nexport {default as extend} from './extend';\nimport SignUpModal from 'flarum/forum/components/SignUpModal';\nimport Stream from 'flarum/common/utils/Stream';\n// 定义路由\napp.routes['nodeloc_signup'] = { path: '/signup', component: SignupPage };\napp.routes['nodeloc_signup_invite'] = { path: '/signup/:doorkey', component: SignupPage };\n\napp.initializers.add('nodeloc-referral', () => {\n// 扩展路由\n  extend(app.routes, 'nodeloc_signup', {\n    path: '/signup',\n    component: SignupPage\n  });\n\n  extend(app.routes, 'nodeloc_signup_invite', {\n    path: '/signup/:doorkey',\n    component: SignupPage\n  });\n  extend(SignUpModal.prototype, 'fields', function (fields) {\n    const isOptional = app.forum.data.attributes['fof-doorman.allowPublic'];\n    const placeholder = isOptional\n      ? app.translator.trans('fof-doorman.forum.sign_up.doorman_placeholder_optional')\n      : app.translator.trans('fof-doorman.forum.sign_up.doorman_placeholder');\n    this.doorkey = Stream(app.doorkey) || Stream('');\n    fields.add(\n      'doorkey',\n      <div className=\"Form-group\">\n        <input className=\"FormControl\" name=\"fof-doorkey\" type=\"text\" placeholder={placeholder} bidi={this.doorkey} disabled={this.loading} />\n      </div>\n    );\n    fields.add('get-invite-code-text', m('.Form-group', m('.get-invite-code-text Alert', \"还没有邀请码 ? \", m('a', { href: 'https://www.nodeloc.com/p/1-guide' }, '点此获取'))));\n  });\n\n  extend(SignUpModal.prototype, 'submitData', function (data) {\n    const newData = data;\n    const doorkeyValue = this.doorkey() !== undefined ? this.doorkey() : $('input[name=\"fof-doorkey\"]').val();\n    console.log(this.doorkey());\n    newData['fof-doorkey'] = doorkeyValue;\n    return newData;\n  });\n});\nextend(IndexPage.prototype, 'navItems', function (items) {\n  items.add(\n    'referral-store',\n    <LinkButton href={app.route('nodeloc.referral.store.index')} icon=\"fas fa-share-alt\">\n        {app.translator.trans('nodeloc-referral.forum.referral')}\n    </LinkButton>,\n    0\n  );\n\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","RedirectToHomeAndOpenModalPage","_Page","apply","arguments","_proto","oninit","vnode","_this","m","route","set","setTimeout","app","show","createModal","view","Page","SignupPage","_RedirectToHomeAndOpe","attrs","doorkey","user","SignUpModal","BuyInviteCode","_Modal","invite_code_price","attribute","invite_code_reward","invite_code_max_number","invite_code_expires","key_count","Stream","className","title","trans","onsubmit","e","_this2","preventDefault","this","loading","method","url","body","then","result","error","type","hide","content","_this3","for","required","id","bidi","Button","onclick","Modal","StoreIndex","_Component","response","data","records","redraw","IndexPage","hero","listItems","sidebarItems","toArray","class","recordsContent","LoadingIndicator","console","log","attributes","length","map","record","text","tempInput","document","createElement","appendChild","select","execCommand","removeChild","Alert","timestamp","created_at","Date","toLocaleString","parseInt","actives","key_cost","is_expire","Component","Extend","add","path","component","extend","fields","placeholder","name","disabled","href","newData","doorkeyValue","undefined","$","val","items","LinkButton","icon"],"sourceRoot":""}